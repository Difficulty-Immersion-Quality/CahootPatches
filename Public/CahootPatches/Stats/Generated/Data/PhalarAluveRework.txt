// =============================== Weapon ===============================

// Rare: Remove +1 Performance
new entry "UND_SwordInStone"
type "Weapon"
using "UND_SwordInStone"
// data "Boosts" "Skill(Performance,1);UnlockSpell(Shout_MAG_Harpers_SingingSword_Container_v1)"
data "Boosts" "UnlockSpell(Shout_MAG_Harpers_SingingSword_Container_v1)"

// Very Rare: Remove 1d4 Radiant damage and +1 Performance
new entry "UND_SwordInStoneV2"
type "Weapon"
using "UND_SwordInStoneV2"
// data "DefaultBoosts" "WeaponEnchantment(2);WeaponProperty(Magical);WeaponDamage(1d4,Radiant)"
data "DefaultBoosts" "WeaponEnchantment(2);WeaponProperty(Magical)"
// data "Boosts" "Skill(Performance, 1);UnlockSpell(Shout_MAG_Harpers_SingingSword_Container_v2)"
data "Boosts" "UnlockSpell(Shout_MAG_Harpers_SingingSword_Container_v2)"

// Legendary: Reduce +2 Performance to +1 Performance
new entry "UND_SwordInStoneV3"
type "Weapon"
using "UND_SwordInStoneV3"
// data "Boosts" "Skill(Performance, 2);UnlockSpell(Shout_MAG_Harpers_SingingSword_Container_v2)"
data "Boosts" "Skill(Performance,1);UnlockSpell(Shout_MAG_Harpers_SingingSword_Container_v2)"

// =============================== Sing/Shriek ===============================
// Change cooldowns back to per short rest, remove ExtraDescription field (inherits from Shillelagh, which has that field added by Syrchalis' mod), and change level 1 cost back to Action

// Level 1
new entry "Shout_MAG_Harpers_SingingSword_Container_v1"
type "SpellData"
using "Shout_MAG_Harpers_SingingSword_Container_v1"
data "ExtraDescription" ""
// data "Cooldown" "OncePerCombat"
data "Cooldown" "OncePerShortRestPerItem"
// data "UseCosts" "BonusActionPoint:1"
data "UseCosts" "ActionPoint:1"

new entry "Shout_MAG_Harpers_SingingSword_Sing_v1"
type "SpellData"
data "SpellType" "Shout"
using "Shout_MAG_Harpers_SingingSword_Sing_v1"
data "ExtraDescription" ""
// data "Cooldown" "OncePerCombat"
data "Cooldown" "OncePerShortRestPerItem"
// data "UseCosts" "BonusActionPoint:1"
data "UseCosts" "ActionPoint:1"

new entry "Shout_MAG_Harpers_SingingSword_Shriek_v1"
type "SpellData"
using "Shout_MAG_Harpers_SingingSword_Shriek_v1"
data "ExtraDescription" ""
// data "Cooldown" "OncePerCombat"
data "Cooldown" "OncePerShortRestPerItem"
// data "UseCosts" "BonusActionPoint:1"
data "UseCosts" "ActionPoint:1"

// Level 2
new entry "Shout_MAG_Harpers_SingingSword_Container_v2"
type "SpellData"
using "Shout_MAG_Harpers_SingingSword_Container_v2"
data "ExtraDescription" ""
// data "Cooldown" "OncePerCombat"
data "Cooldown" "OncePerShortRestPerItem"

new entry "Shout_MAG_Harpers_SingingSword_Sing_v2"
type "SpellData"
data "SpellType" "Shout"
using "Shout_MAG_Harpers_SingingSword_Sing_v2"
data "ExtraDescription" ""
// data "Cooldown" "OncePerCombat"
data "Cooldown" "OncePerShortRestPerItem"

new entry "Shout_MAG_Harpers_SingingSword_Shriek_v2"
type "SpellData"
using "Shout_MAG_Harpers_SingingSword_Shriek_v2"
data "ExtraDescription" ""
// data "Cooldown" "OncePerCombat"
data "Cooldown" "OncePerShortRestPerItem"

// Level 3
new entry "Shout_MAG_Harpers_SingingSword_Container_v3"
type "SpellData"
using "Shout_MAG_Harpers_SingingSword_Container_v3"
data "ExtraDescription" ""
// data "Cooldown" "OncePerCombat"
data "Cooldown" "OncePerShortRestPerItem"

new entry "Shout_MAG_Harpers_SingingSword_Sing_v3"
type "SpellData"
data "SpellType" "Shout"
using "Shout_MAG_Harpers_SingingSword_Sing_v3"
data "ExtraDescription" ""
// data "Cooldown" "OncePerCombat"
data "Cooldown" "OncePerShortRestPerItem"

new entry "Shout_MAG_Harpers_SingingSword_Shriek_v3"
type "SpellData"
using "Shout_MAG_Harpers_SingingSword_Shriek_v3"
data "ExtraDescription" ""
// data "Cooldown" "OncePerCombat"
data "Cooldown" "OncePerShortRestPerItem"

// =============================== Sword Dance ===============================
// Allow you to use Intelligence or Wisdom in place of Charisma for Performance checks (so Bladesinger Wizards can make optimal use of this passive as well)

new entry "MAG_SwordInStone_SwordDance"
type "PassiveData"
using "MAG_SwordInStone_SwordDance"
// When you hit a creature in melee, you &lt;LSTag Type="Status" Tooltip="MAG_HARPERS_SINGING_SWORD_DISTRACTED"&gt;Distract&lt;/LSTag&gt; it and gain 1 stack of &lt;LSTag Type="Status" Tooltip="MAG_MOMENTUM"&gt;Momentum&lt;/LSTag&gt; if you succeed a &lt;LSTag Tooltip="Performance"&gt;Performance&lt;/LSTag&gt; &lt;LSTag Tooltip="AbilityCheck"&gt;Check&lt;/LSTag&gt;. If your Intelligence or Wisdom &lt;LSTag Tooltip="AbilityModifier"&gt;Modifier&lt;/LSTag&gt; is higher than your Charisma Modifier, you can substitute it for Performance Checks.
data "Description" "hf21d176ege20eg44eeg944egaf503d8983d6;1"
// data "StatsFunctorContext" "OnDamage"
// data "Conditions" "IsMeleeAttack() and AttackedWithPassiveSourceWeapon()"
// data "StatsFunctors" "ApplyStatus(MAG_HARPERS_SINGING_SWORD_DISTRACTED,100,2,,,,SkillCheck(Skill.Performance,15+math.max(GetModifier(context.Target.Wisdom),GetModifier(context.Target.Charisma))))"
// data "Boosts" ""
data "Boosts" "IF(CHT_WisdomGreaterThanCharisma() and CHT_WisdomGreaterThanIntelligence()):Skill(Performance,(WisdomModifier-CharismaModifier));IF(CHT_IntelligenceGreaterThanCharisma() and not CHT_WisdomGreaterThanIntelligence()):Skill(Performance,(IntelligenceModifier-CharismaModifier))"

// =============================== Mesmerizing Grace ===============================
// Remove extra reaction

new entry "MAG_SwordInStone_MesmerizingGrace"
type "PassiveData"
using "MAG_SwordInStone_MesmerizingGrace"
// You gain 1 stack of &lt;LSTag Type="Status" Tooltip="MAG_MOMENTUM"&gt;Momentum&lt;/LSTag&gt; each turn.
data "Description" "hf8e82c23ga004g4430g8433g56b33548b882;1"
// data "Boosts" "ActionResource(ReactionActionPoint,1,0)"
data "Boosts" ""
// data "StatsFunctorContext" "OnTurn"
// data "StatsFunctors" "ApplyStatus(MAG_MOMENTUM,100,1);ApplyStatus(SELF,MAG_MOMENTUM_DURATION_TECHNICAL,100,1)"
